<!DOCTYPE html> 
<html> 
	<head> 
	<title>Log In to Farmtab</title> 
	<meta name="viewport" content="width=device-width, initial-scale=1"> 
	<link rel="stylesheet" href="http://code.jquery.com/mobile/1.0/jquery.mobile-1.0.min.css" />
	<link rel="stylesheet" href="ft_mobile.css" />
	<script type="text/javascript" src="http://code.jquery.com/jquery-1.6.4.min.js"></script>
	<script type="text/javascript" src="http://code.jquery.com/mobile/1.0/jquery.mobile-1.0.min.js"></script>
</head> 
<body> 

<div data-role="page">

	<div data-role="header">
		<img src="img/carrot.png" class="ui-btn-left" alt="" height="30px"/>
		<h1>Farmer Login</h1>
	</div><!-- /header -->

	<div data-role="content">
		<form id="form1" method="post" action="backend.php" autocomplete="off" data-ajax="false">
			<label for="email" class="ui-hidden-accessible">Email</label>
			<input id="email" name="email" type="email" placeholder="Email" required />
			<label for="password" class="ui-hidden-accessible">Password</label>
			<input id="password" name="password" class="password" placeholder="Password" required />
			<input type="hidden" name="type" value ="login" />
			<input type="submit" value="Sign up" />
		</form>
	</div><!-- /content -->
</div><!-- /page -->
<div id="alert" data-role="page">
	
		<div data-role="header" data-theme="d">
			<h1>Access Denied</h1>

		</div>
		
		<div data-role="content" data-theme="c">
			<p>The username or password you entered is invalid</p>   
			<a href="docs-dialogs.html" data-role="button" data-rel="back" data-theme="c">Return</a>    
		</div>
	</div>
</body>

<script type="text/javascript">
$( '#aboutPage' ).live( 'pageinit',function(event){


	var API_KEY = '124df26asdf';
	var user_token;
	



	$("#form1").submit(function() {

		var action = $(this).attr('action');
		var form_data = {
			email: $("#email").val(),
			password: $("#password").val(),
			api_key: API_KEY,
			type: "login"
		};

		$.ajax({
			type: "POST",
			url: action,
			data: form_data,
			success: function(response)
			{
				if(response['status'] == 'success') {
					user_token = response['user_token'];
					$("#login").slideUp('slow', function() {
						$.mobile.changePage("userlist.html");
					});
				} else
					$.mobile.changePage( "#alert", {
						transition: "pop",
						reverse: false,
						changeHash: false
					});
			}
		});

		return false;
	});

});
</script>
</html>